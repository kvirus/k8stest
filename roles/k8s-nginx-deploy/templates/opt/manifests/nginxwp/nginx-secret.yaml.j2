{# Копирование сертификатов#}
---
- name: "Сохраняем сертификаты в Secrets"
  kubernetes.core.k8s:
    state: "present"
    kind: "Secret"
    namespace: "{{ k8s_nginx_deploy_cfg['namespace'] }}"
    name: "{{ k8s_nginx_deploy_cfg['secret_file_name'] }}"
    api_version: v1
    type: kubernetes.io/tls
    data:
      registry.crt: "{{ lookup('file', 'files/ssl/registry/server.crt') | b64encode }}"
      registry.key: "{{ lookup('file', 'files/ssl/registry/server.key') | b64encode }}"
      wordpress.crt: "{{ lookup('file', 'files/ssl/wordpress/server.crt') | b64encode }}"
      wordpress.key: "{{ lookup('file', 'files/ssl/wordpress/server.key') | b64encode }}"